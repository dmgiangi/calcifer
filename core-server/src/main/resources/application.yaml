spring:
  application:
    name: core-server
  data:
    mongodb:
      auto-index-creation: true
  mongodb:
    database: calcifer

# OpenAPI / Swagger UI
springdoc:
  api-docs:
    path: /v3/api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
  info:
    title: Calcifer Core Server API
    description: IoT Digital Twin management system with safety rules and override management
    version: 1.0.0
    contact:
      name: Calcifer Team
    license:
      name: MIT

# Actuator & Observability
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics,loggers
  endpoint:
    health:
      show-details: when_authorized
      show-components: when_authorized
      probes:
        enabled: true
  health:
    redis:
      enabled: true
    rabbit:
      enabled: true
  prometheus:
    metrics:
      export:
        enabled: true
  tracing:
    propagation:
      type: w3c
    baggage:
      enabled: true
      correlation:
        enabled: true
    export:
      enabled: true
  observations:
    key-values:
      application: ${spring.application.name}
  metrics:
    tags:
      application: ${spring.application.name}
    distribution:
      percentiles-histogram:
        http.server.requests: true
      slo:
        http.server.requests: 50ms, 100ms, 200ms, 500ms, 1s

# Logging with correlation ID (traceId/spanId)
logging:
  pattern:
    correlation: "[${spring.application.name:},%X{traceId:-},%X{spanId:-}] "
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} ${LOG_LEVEL_PATTERN:-%5p} ${PID:- } --- [%15.15t] %-40.40logger{39} : %m%n"

# Application-specific configuration
app:
  iot:
    # Scheduled reconciler polling interval (drift detection / health check)
    polling-interval-ms: 5000
  reconciliation:
    # Debounce window for immediate reconciler (accumulates rapid events)
    debounce-ms: 50
